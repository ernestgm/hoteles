<script>

    function UserService($filter){
        var service = {};

        service.GetAll = GetAll;
        service.GetById = GetById;
        service.Save = Save;

        return service;

        function GetAll() {
            return getUsers();
        }

        function GetById(id) {
            var filtered = $filter('filter')(getUsers(), { id: id });
            var user = filtered.length ? filtered[0] : null;

            return user;
        }

        function getUsers() {
            if (!localStorage.users) {
                localStorage.users = JSON.stringify([]);
            }

            return JSON.parse(localStorage.users);
        }

        function Save(users) {
            localStorage.users = JSON.stringify(users);
            return;
        }

    }

    function WSHotelService($filter){
        var wsservice = {};

        wsservice.GetAll = GetAll;
        wsservice.GetById = GetById;
        wsservice.Save = Save;
        wsservice.generateName = generateName;
        wsservice.Delete = Delete;

        return wsservice;

        function GetAll() {
            return getData();
        }

        function GetById(id) {
            var filtered = $filter('filter')(getData(), { hotelId: id });
            var data = filtered.length ? filtered[0] : null;

            return data;
        }

        function Delete(id) {
            var hotels = getData();
            for (var i = 0; i < hotels.length; i++) {
                var hotel = hotels[i];
                if (hotel.hotelId === id) {
                    hotels.splice(i, 1);
                    break;
                }
            }
            wsservice.Save(hotels);

            return;
        }

        function getData() {
            if (!localStorage.wshotels) {
                localStorage.wshotels = JSON.stringify([]);
            }

            return JSON.parse(localStorage.wshotels);
        }

        function Save(item) {
            localStorage.wshotels = null;
            localStorage.wshotels = JSON.stringify(item);
            return;
        }

        function generateName(name){
            var str = name;

            var re = /cubanacan/i;
            str = str.replace(re, "");
            str = str.toLowerCase();
            var substrs = str.split(" ");

            str = "";
            for (word in substrs)
            {
                if (substrs[word] != ""){
                    str += substrs[word];
                }
            }

            var url_name = str;
            return url_name;
        }

    }

    angular
            .module('inspinia')
            .factory('UserService', UserService)
            .factory('WSHotelService', WSHotelService);
</script>